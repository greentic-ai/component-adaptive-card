{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Adaptive Card invocation input",
  "type": "object",
  "required": ["card_spec"],
  "properties": {
    "envelope": {
      "description": "Optional Greentic invocation envelope metadata.",
      "type": "object"
    },
    "card_source": {
      "type": "string",
      "enum": ["inline", "asset", "catalog"],
      "default": "inline",
      "description": "Where to load the card from."
    },
    "card_spec": {
      "type": "object",
      "description": "Details for resolving the card source.",
      "default": {
        "inline_json": {}
      },
      "properties": {
        "inline_json": { "type": ["object", "array"] },
        "asset_path": { "type": "string" },
        "catalog_name": { "type": "string" },
        "template_params": { "type": ["object", "array"] },
        "asset_registry": {
          "type": "object",
          "additionalProperties": { "type": "string" },
          "description": "Optional mapping of asset or catalog names to concrete paths."
        }
      }
    },
    "node_id": {
      "type": "string",
      "description": "Optional node id used to scope persisted state and helper context."
    },
    "payload": {
      "type": ["object", "array", "null"],
      "description": "Explicit input payload used for binding/expression resolution."
    },
    "session": {
      "type": ["object", "array", "null"],
      "description": "Optional explicit session metadata (not injected by the runner)."
    },
    "state": {
      "type": ["object", "array", "null"],
      "description": "Optional explicit state override (persistent state uses state-store)."
    },
    "interaction": {
      "type": "object",
      "required": ["interaction_type", "action_id", "card_instance_id"],
      "properties": {
        "enabled": { "type": "boolean" },
        "interaction_type": {
          "type": "string",
          "enum": ["Submit", "Execute", "OpenUrl", "ShowCard", "ToggleVisibility"]
        },
        "action_id": { "type": "string" },
        "verb": { "type": ["string", "null"] },
        "raw_inputs": { "type": ["object", "array", "string", "null"] },
        "card_instance_id": { "type": "string" },
        "metadata": { "type": ["object", "array", "null"] }
      }
    },
    "mode": {
      "type": "string",
      "enum": ["render", "validate", "renderAndValidate"],
      "default": "renderAndValidate",
      "description": "Whether to render, validate only, or both."
    }
  }
}
