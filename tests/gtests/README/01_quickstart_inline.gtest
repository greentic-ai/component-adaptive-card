#SET FLOW=${WORK_DIR}/flows/main.ygtc
#MKDIR ${WORK_DIR}/flows
#WRITE ${FLOW} <<<EOF
id: main
type: messaging
start: start
nodes:
  start:
    op: {}
    routing:
      - to: end
  end:
    op: {}
    routing:
      - out: true
EOF
#RUN cp ${REPO_ROOT}/component.manifest.json ${WORK_DIR}/component.manifest.json
#EXPECT_EXIT 0
#RUN cp ${REPO_ROOT}/card.json ${WORK_DIR}/card.json
#EXPECT_EXIT 0
#RUN cp ${REPO_ROOT}/target/wasm32-wasip2/release/component_adaptive_card.wasm ${WORK_DIR}/component_adaptive_card.wasm
#EXPECT_EXIT 0
#RUN greentic-dev flow add-step --flow ${FLOW} --node-id adaptive-card --operation card --payload '{"input":{"card_source":"asset","card_spec":{"asset_path":"card.json","template_params":{}},"mode":"renderAndValidate"}}' --local-wasm ./component_adaptive_card.wasm --manifest ./component.manifest.json --after start
#EXPECT_EXIT 0
#SET RESOLVE=${FLOW}.resolve.json
#WRITE ${RESOLVE} <<<EOF
{
  "schema_version": 1,
  "flow": "main.ygtc",
  "nodes": {
    "start": {
      "source": {
        "kind": "oci",
        "ref": "oci://ghcr.io/greentic-ai/components/component-adaptive-card:latest"
      }
    },
    "end": {
      "source": {
        "kind": "oci",
        "ref": "oci://ghcr.io/greentic-ai/components/component-adaptive-card:latest"
      }
    },
    "adaptive-card": {
      "source": {
        "kind": "oci",
        "ref": "oci://ghcr.io/greentic-ai/components/component-adaptive-card:latest"
      }
    }
  }
}
EOF
#RUN greentic-dev flow doctor ${FLOW}
#EXPECT_EXIT 0
#SAVE_ARTIFACT ${FLOW}
#SAVE_ARTIFACT ${FLOW}.resolve.json
